<div class="song">
  <div class="song__start" (click)="setTrack()">
    @if ((isCurrentSong$ | async) && (isPlaying$ | async)) {
    <div class="equalizer">
      <div></div>
      <div></div>
      <div></div>
      <div></div>
    </div>
    <mat-icon class="song__start-icon">pause</mat-icon>
    } @else {
    <p [class.text-[var(--main-color)]]="isCurrentSong$ | async" class="song__start-index">{{ index + 1 }}</p>
    <mat-icon class="song__start-icon">play_arrow</mat-icon>
    }
  </div>

  <div class="song__content">
    <div class="w-full grid gap-2 items-center" style="grid-template-columns: 52% auto">
      <div class="flex gap-3 w-full">
        @if (!hideImg) {
        <img [src]="song.album.cover_medium" loading="lazy" class="w-10 h-10 rounded" alt="song_cover" />
        }

        <div class="flex flex-col justify-center">
          <span class="one-stroke-text" [class.text-[var(--main-color)]]="(isCurrentSong$ | async)">
            {{ song.title }}
          </span>

          @if (!hideArtist) {
          <div class="flex items-start">
            @if (song.contributors?.length) {
            @for (artist of song.contributors; track $index) {
            <a [routerLink]="['/artist', artist.id]" class="song__content-artist one-stroke-text">
              {{ artist.name }}
            </a>
            @if (!isLastSong($index)) {<span class="song__content-artist">,&nbsp;</span>}}
            } @else {
            <a [routerLink]="['/artist', song.artist.id]" class="song__content-artist one-stroke-text">
              {{ song.artist.name }}
            </a>
            }
          </div>
          }

        </div>
      </div>

      @if (!hideAlbum) {
      <a class="text-[var(--text-color-secondary)] truncate w-fit max-w-full"
        [routerLink]="['/album/', song.album.id]">{{song.album.title}}</a>
      }
    </div>

    <div class="favorite-button w-fit flex justify-end">
      <button (click)="toggleFavorite()" class="icon-button" [class.text-[var(--main-color)]]="isFavorite">
        <mat-icon [fontIcon]="getFavoriteIcon()"></mat-icon>
      </button>
    </div>
    <div class="flex">
      <p class="flex items-center text-sm text-right mr-2 font-normal">{{ getDuration(song.duration) }}</p>
      <button class="icon-button more-button">
        <mat-icon fontIcon="more_horiz"></mat-icon>
      </button>
    </div>
  </div>
</div>
